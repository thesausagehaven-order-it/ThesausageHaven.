<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>The Sausage Haven</title>
  <script src="https://cdn.tailwindcss.com"></script>

  <script>
    const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbxJGHfyO9eWIn6rdwUhkmVRgqPnX38FPwz58UekuvKdSb_onFt-6nGo4n3NEo2oC5ll/exec";
    const STAFF_PASSWORD = "Staff123";
  </script>

  <style>
    /* Walk-in Form Styling */
    #staffWalkIn {
      font-family: Arial, sans-serif;
      background: #fafafa;
      padding: 20px;
    }
    #staffWalkIn .container {
      max-width: 450px;
      margin: auto;
      background: white;
      padding: 20px;
      border-radius: 12px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }
    #staffWalkIn select, 
    #staffWalkIn input, 
    #staffWalkIn textarea {
      width: 100%;
      padding: 10px;
      border-radius: 8px;
      border: 1px solid #ccc;
      margin-bottom: 12px;
    }
    #staffWalkIn button {
      width: 100%;
      padding: 12px;
      background: #ff6600;
      color: white;
      font-size: 15px;
      border: none;
      border-radius: 8px;
      cursor: pointer;
    }
    #staffWalkIn button:hover {
      background: #e65c00;
    }
  </style>
</head>

<body class="bg-gray-50 font-sans text-gray-800">

<!-- HEADER -->
<header class="bg-red-600 text-white p-6 shadow-md">
  <div class="max-w-6xl mx-auto flex justify-between items-center">
    <h1 class="text-2xl md:text-3xl font-bold">The Sausage Haven</h1>
    <nav class="space-x-4">
      <a href="#order" class="hover:underline">Order Now</a>
      <a href="#contact" class="hover:underline">Contact</a>
      <button id="openStaffLogin" class="ml-4 bg-white text-red-600 px-3 py-1 rounded hover:bg-gray-100">
        Staff
      </button>
    </nav>
  </div>
</header>

<!-- HERO SECTION -->
<section class="bg-gradient-to-r from-red-400 to-red-600 text-white py-16 text-center">
  <div class="max-w-4xl mx-auto px-4">
    <h2 class="text-3xl md:text-4xl font-bold mb-3">Fresh & Delicious Sausages Delivered!</h2>
    <p class="mb-6">Order online and get your favorite sausages delivered to your hostel.</p>
    <a href="#order" class="bg-white text-red-600 font-bold px-6 py-2 rounded shadow hover:bg-gray-100 transition">
      Place Your Order
    </a>
  </div>
</section>

<!-- MAIN CONTENT -->
<main class="max-w-6xl mx-auto p-6 space-y-10">

  <!-- CUSTOMER ORDER FORM -->
  <section id="order" class="bg-white p-8 rounded-lg shadow-md">
    <h3 class="text-2xl font-bold mb-4 text-center">Place Your Order</h3>

    <form id="customerOrderForm" class="space-y-4" method="POST" action="https://script.google.com/macros/s/AKfycbxJGHfyO9eWIn6rdwUhkmVRgqPnX38FPwz58UekuvKdSb_onFt-6nGo4n3NEo2oC5ll/exec">
      <input type="hidden" name="orderType" value="Customer">
      <div>
        <label>Full Name</label>
        <input name="FullName" type="text" required class="w-full border rounded px-3 py-2">
      </div>

      <div>
        <label>Phone Number</label>
        <input name="PhoneNumber" type="tel" required class="w-full border rounded px-3 py-2">
      </div>

      <div>
        <label>Delivery Location</label>
        <input name="DeliveryLocation" type="text" required class="w-full border rounded px-3 py-2">
      </div>

      <div>
        <label>Quantity</label>
        <input name="Quantity" type="number" min="1" max="50" required class="w-full border rounded px-3 py-2">
      </div>

      <div>
        <label>Preferred Delivery Time</label>
        <input name="DeliveryTime" type="time" required class="w-full border rounded px-3 py-2">
      </div>

      <div>
        <label>Additional Notes</label>
        <textarea name="AdditionalNotes" rows="3" class="w-full border rounded px-3 py-2"></textarea>
      </div>

       <div>
        <label>Payment Method</label>
        <select name="PaymentMethod" required class="w-full border rounded px-3 py-2">
          <option value="">Select...</option>
          <option value="Cash">Cash on Delivery</option>
          <option value="MoMo">Mobile Money (MoMo)</option>
        </select>
      </div>

      <button id="submitOrderBtn" type="submit"
              class="bg-red-600 text-white px-6 py-2 rounded font-semibold hover:bg-red-700">
        Submit Order
      </button>

      <p id="orderStatus" class="text-center text-sm text-gray-600 hidden"></p>
    </form>
  </section>
</main>

<!-- STAFF LOGIN MODAL -->
<div id="staffModal" class="fixed inset-0 bg-black bg-opacity-40 hidden items-center justify-center z-40">
  <div class="bg-white rounded-lg shadow-lg w-full max-w-3xl">
    <div class="p-6 md:flex md:gap-6">

      <div class="md:w-1/2">
        <h3 class="text-xl font-bold mb-3">Staff Access</h3>
        <input id="modalPassword" type="password" class="w-full border rounded px-3 py-2 mb-3" placeholder="Password">

        <div class="flex gap-3">
          <button id="openWalkInBtn" class="bg-red-600 text-white px-4 py-2 rounded">Walk-in Entry</button>
          <button id="openDashboardBtn" class="bg-gray-700 text-white px-4 py-2 rounded">Dashboard</button>
        </div>
      </div>

      <div class="md:w-1/2 border-l md:pl-6 mt-4 md:mt-0">
        <h4 class="font-semibold mb-2">Staff actions</h4>
        <ul class="text-sm list-disc list-inside">
          <li>Enter walk-in orders</li>
          <li>View pending deliveries</li>
          <li>Mark orders as delivered</li>
        </ul>
      </div>
    </div>

    <div class="px-6 py-3 border-t text-right">
      <button id="closeStaffModal" class="px-4 py-2 rounded hover:bg-gray-100">Close</button>
    </div>
  </div>
</div>

<!-- WALK-IN FORM -->
<section id="staffOrderForm" class="hidden">
  <div class="container">
    <h2>Walk-In Order</h2>

    <form id="staffOrderForm" method="POST" action="https://script.google.com/macros/s/AKfycbxJGHfyO9eWIn6rdwUhkmVRgqPnX38FPwz58UekuvKdSb_onFt-6nGo4n3NEo2oC5ll/exec">
      <input type="hidden" name="orderType" value="Staff">
      <label>Full Name</label>
      <input type="text" name="fullName" placeholder="Full Name" required>

      <label>Phone Number</label>
      <input type="text" name="phoneNumber" placeholder="Phone" required>

      <label>Quantity</label>
      <input type="number" name="quantity" required min="1">
     
      <label>Additional Notes</label>
      <textarea name="notes" rows="3"></textarea>

      <label>Payment Method</label>
      <select name="paymentMethod">
        <option value="cash">Cash</option>
        <option value="momo">MoMo</option>
      </select>
        
        <label>Shop</label>
       <select name="DeliveryPoint" required>
        <option value="">Select Shop</option>
        <option value="JRS01">J's Royal</option>
        <option value="GHS01">Gusss Hostel</option>
      </select>


      <label>Delivery Staff</label>
      <select name="deliveryStaff" required>
        <option value="">Select Staff</option>
        <option value="DM001">DM001</option>
        <option value="DM002">DM002</option>
        <option value="DM003">DM003</option>
        <option value="DM004">DM004</option>
        <option value="DM005">DM005</option>
        <option value="DM006">DM006</option>
        <option value="DM007">DM007</option>
        <option value="DM008">DM008</option>
        <option value="DM009">DM009</option>
        <option value="DM010">DM010</option>
        <option value="DM011">DM011</option>
        <option value="DM012">DM012</option>
      </select>
      

      <button type="submit">Submit Walk-In Order</button>
    </form>


    <div id="response"></div>
  </div>
</section>

<!-- STAFF DASHBOARD -->
<section id="staffDashboard" class="hidden py-10 bg-gray-50">
  <div class="max-w-5xl mx-auto bg-white p-6 rounded shadow">
    <div class="flex justify-between">
      <h3 class="text-xl font-bold">Pending Deliveries</h3>
      <button id="closeDashboard" class="px-3 py-1 rounded bg-gray-200">Close</button>
    </div>

    <table id="ordersTable" class="w-full border-collapse text-sm mt-4">
      <thead class="bg-gray-100">
        <tr>
          <th class="border px-3 py-2">Order No</th>
          <th class="border px-3 py-2">Customer</th>
          <th class="border px-3 py-2">Phone</th>
          <th class="border px-3 py-2">Qty</th>
          <th class="border px-3 py-2">Payment</th>
          <th class="border px-3 py-2">Delivery</th>
          <th class="border px-3 py-2">Invoice</th>
          <th class="border px-3 py-2">Action</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>

    <p id="dashboardStatus" class="hidden text-sm mt-3"></p>
  </div>
</section>

<!-- CONTACT -->
<section id="contact" class="bg-gray-100 p-6 text-center mt-10">
  <h4 class="text-lg font-bold mb-2">Contact Us</h4>
  <p>Phone: 0256507851</p>
  <p>Email: thesausagehaven@gmail.com</p>
</section>

<footer class="bg-red-600 text-white p-6 mt-10 text-center">
  Â© 2025 The Sausage Haven
</footer>

<!-- SCRIPTS -->
<script>
  /* STAFF LOGIN */
  const staffModal = document.getElementById('staffModal');

  document.getElementById('openStaffLogin').onclick = () => staffModal.classList.remove('hidden');
  document.getElementById('closeStaffModal').onclick = () => staffModal.classList.add('hidden');

  document.getElementById('openWalkInBtn').onclick = () => {
    if (modalPassword.value !== STAFF_PASSWORD) return alert("Wrong password");
    staffModal.classList.add('hidden');
    document.getElementById('staffWalkIn').classList.remove('hidden');
  };

  document.getElementById('openDashboardBtn').onclick = () => {
    if (modalPassword.value !== STAFF_PASSWORD) return alert("Wrong password");
    staffModal.classList.add('hidden');
    document.getElementById('staffDashboard').classList.remove('hidden');
    loadOrders();
  };

  document.getElementById('closeDashboard').onclick = () => {
    document.getElementById('staffDashboard').classList.add('hidden');
  };

  

  /* DASHBOARD LOAD */
  async function loadOrders() {
    const res = await fetch(SCRIPT_URL + "?type=assignedPending");
    const orders = await res.json();

    const body = document.querySelector("#ordersTable tbody");
    body.innerHTML = "";

    if (orders.length === 0) {
      body.innerHTML = `<tr><td colspan="8" class="text-center py-4">No pending deliveries.</td></tr>`;
      return;
    }

    orders.forEach(o => {
      const row = document.createElement("tr");
      row.innerHTML = `
        <td class="border px-3 py-2">${o.OrderNumber}</td>
        <td class="border px-3 py-2">${o.FullName}</td>
        <td class="border px-3 py-2">${o.PhoneNumber}</td>
        <td class="border px-3 py-2">${o.Quantity}</td>
        <td class="border px-3 py-2">${o.PaymentMethod}</td>
        <td class="border px-3 py-2">${o.DeliveryPoint}</td>
        <td class="border px-3 py-2"><a target="_blank" href="${o.InvoiceUrl}">Invoice</a></td>
        <td class="border px-3 py-2">
          <button class="bg-green-600 hover:bg-green-700 text-white px-3 py-1 rounded">Delivered</button>

        </td>
      `;
      body.appendChild(row);
    });
  }

  async function markDelivered(row) {
    await fetch(SCRIPT_URL, {
      method: "POST",
      body: new URLSearchParams({ action: "markDelivered", row })
    });
    loadOrders();
  }
</script>

</body>
</html>




